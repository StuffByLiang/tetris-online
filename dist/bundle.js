!function(e){var a={};function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,a,t){i.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:t})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,a){if(1&a&&(e=i(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var n in e)i.d(t,n,function(a){return e[a]}.bind(null,n));return t},i.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(a,"a",a),a},i.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},i.p="",i(i.s=0)}([function(e,a,i){e.exports=i(25)},function(e,a){window.game={bag:{},boardPosition:[[],[]],spawnPiece:function(){var e,a,i=this.bag.currentBag[player.currentBag].split(",");player.currentPieceName=i[player.currentPiece],player.currentPiece++,player.currentPiece>=7&&(player.currentPiece=0,player.currentBag++),a=game.getPieceRotation(player.currentPieceName),e=game.getPieceNumber(player.currentPieceName),this.piece=new this.pieceObject(3,-1,player.currentPieceName,e,a),e=game.getPieceColor(e),this.ghost=new this.ghostObject(e),key.pressed[key.down]>0&&(game.piece.checkCollision(1)||(clearInterval(game.piece.interval),game.piece.interval=setInterval(game.piece.gravityInterval,settings.gravity))),this.piece.checkCollision(1)||(this.piece.y++,this.piece.y>this.piece.lowestLine&&(this.piece.lowestLine=this.piece.y,this.rotationLimit=0,clearTimeout(this.piece.lockDownTimer))),game.ghost.update(),game.piece.update(),game.drawBoard(),player.canHold||player.firstHold?player.canHold=!0:player.firstHold=!0},hold:function(){if(player.canHold)if(player.firstHold){player.canHold=!1,player.currentHoldPiece=[player.currentPieceName,player.currentPieceName=player.currentHoldPiece][0],clearInterval(this.piece.interval),clearTimeout(this.piece.lockDownTimer),this.piece.lockDownTimer=!1,this.drawHold(player.currentHoldPiece);var e=game.getPieceRotation(player.currentPieceName),a=game.getPieceNumber(player.currentPieceName);this.piece=new this.pieceObject(3,-1,player.currentPieceName,a,e),a=game.getPieceColor(a),this.ghost=new this.ghostObject(a),key.pressed[key.down]>0&&(game.piece.checkCollision(1)||(clearInterval(game.piece.interval),game.piece.interval=setInterval(game.piece.gravityInterval,75))),this.piece.checkCollision(1)||(this.piece.y++,this.piece.y>this.piece.lowestLine&&(this.piece.lowestLine=this.piece.y,this.rotationLimit=0,clearTimeout(this.piece.lockDownTimer))),game.ghost.update(),game.piece.update(),game.drawBoard()}else player.canHold=!1,player.currentHoldPiece=player.currentPieceName,clearInterval(this.piece.interval),clearTimeout(this.piece.lockDownTimer),this.piece.lockDownTimer=!1,this.spawnPiece(),this.drawHold(player.currentHoldPiece),this.drawQueue()},pieceObject:function(e,a,i,t,n){this.x=e,this.y=a,this.pieceName=i,this.color=t,this.angle=0,this.oldX=[0,0,0,0],this.oldY=[0,0,0,0],this.rotations=n,this.lowestLine=0,this.rotationLimit=0,this.die=function(){if(game.piece.checkCollision(1)){clearInterval(game.piece.interval),clearTimeout(game.piece.lockDownTimer),game.piece.lockDownTimer=!1;for(var e=game.piece.rotations[game.piece.angle].split("|"),a=0;a<=3;a++){var i,t,n;n=e[a].split(","),i=Number(n[0]),t=Number(n[1]),game.boardPosition[game.piece.x+i][game.piece.y+t]=game.piece.color}game.clearLines(),record.recordBoardPosition(),game.applyGarbage(),game.checkLoss()?(console.log("YOU FUCKING LOST"),game.losingGray()):(game.spawnPiece(),game.drawQueue())}},this.gravityInterval=function(){game.piece.checkCollision(1)||(game.piece.y++,game.piece.y>game.piece.lowestLine&&(game.piece.lowestLine=game.piece.y,game.piece.rotationLimit=0,clearTimeout(game.piece.lockDownTimer),game.piece.lockDownTimer=!1),player.tspinRotate=!1,game.ghost.update(),game.piece.update(),game.drawBoard()),game.piece.lockdown()},this.interval=setInterval(this.gravityInterval,1e3),this.lockDownTimer=!1,this.update=function(){for(var e=this.rotations[this.angle].split("|"),a=0;a<=3;a++){var i,n,r;r=e[a].split(","),i=Number(r[0]),n=Number(r[1]),t=game.getPieceColor(game.piece.color),draw.makeBlock(1+24*game.piece.x,1+24*game.piece.y,i,n,t,tetrisBoard.canvas)}},this.lockdown=function(e){game.piece.checkCollision(1)?game.piece.rotationLimit>15?game.piece.die():game.piece.lockDownTimer||(game.piece.lockDownTimer=setTimeout(game.piece.die,500)):(clearTimeout(game.piece.lockDownTimer),game.piece.lockDownTimer=!1)},this.checkCollision=function(e){for(var a=this.rotations[this.angle].split("|"),i=0;i<=3;i++){var t=0,n=0,r=a[i].split(","),o=Number(r[0]),c=Number(r[1]);switch(e){case 0:t=1;break;case 1:n=1;break;case 2:t=-1;break;case 3:n=-1;break;default:console.log("no such direction")}if(this.x+o+t<0||this.x+o+t>9||this.y+c+n<0||this.y+c+n>21)return!0;if(0!==game.boardPosition[this.x+o+t][this.y+c+n])return!0}return!1},this.canRotate=function(e){var a;(a=this.angle+e)<0&&(a=3),a>3&&(a=0);for(var i=0;i<=4;i++){var t,n;if("I"===player.currentPieceName){if(0===this.angle&&1===e||3===this.angle&&-1===e||1===this.angle&&-1===e||2===this.angle&&1===e)switch(i){case 0:t=0,n=0;break;case 1:t=-2,n=0;break;case 2:t=1,n=0;break;case 3:t=-2,n=1;break;case 4:t=1,n=-2}if((1===this.angle&&-1===e||2===this.angle&&1===e)&&(t*=-1,n*=-1),1===this.angle&&1===e||0===this.angle&&-1===e||2===this.angle&&-1===e||3===this.angle&&1===e)switch(i){case 0:t=0,n=0;break;case 1:t=-1,n=0;break;case 2:t=2,n=0;break;case 3:t=-1,n=-2;break;case 4:t=2,n=1}(2===this.angle&&-1===e||3===this.angle&&1===e)&&(t*=-1,n*=-1)}else{if(0===this.angle&&1===e||2===this.angle&&-1===e||1===this.angle&&-1===e||1===this.angle&&1===e)switch(i){case 0:t=0,n=0;break;case 1:t=-1,n=0;break;case 2:t=-1,n=-1;break;case 3:t=-2,n=2;break;case 4:t=-1,n=2}if((1===this.angle&&-1===e||1===this.angle&&1===e)&&(t*=-1,n*=-1),2===this.angle&&1===e||0===this.angle&&-1===e||3===this.angle&&-1===e||3===this.angle&&1===e)switch(i){case 0:t=0,n=0;break;case 1:t=1,n=0;break;case 2:t=1,n=-1;break;case 3:t=0,n=2;break;case 4:t=1,n=2}(3===this.angle&&-1===e||3===this.angle&&1===e)&&(t*=-1,n*=-1)}for(var r=0,o=this.rotations[a].split("|"),c=0;c<=3;c++){var s=o[c].split(","),l=Number(s[0]),m=Number(s[1]);if(this.x+l+t<0||this.x+l+t>9||this.y+m+n<0||this.y+m+n>21)break;if(0===game.boardPosition[this.x+l+t][this.y+m+n]&&4==++r)return this.x+=t,this.y+=n,!0}}return!1}},ghostObject:function(e){this.color=shadeColor(e,-.5),this.pieceName=player.currentPieceName,this.angle=game.piece.angle,this.rotations=game.piece.rotations[game.piece.angle],this.update=function(){for(this.x=game.piece.x,this.y=game.piece.y,this.angle=game.piece.angle,this.rotations=game.piece.rotations[game.piece.angle];!this.checkDown();)this.y++;var e=this.rotations.split("|");draw.clearCanvas(tetrisBoard.canvas);for(var a=0;a<=3;a++){var i,t,n;n=e[a].split(","),i=Number(n[0]),t=Number(n[1]),draw.makeBlock(1+24*this.x,1+24*this.y,i,t,this.color,tetrisBoard.canvas)}},this.checkDown=function(){for(var e=this.rotations.split("|"),a=0;a<=3;a++){var i=e[a].split(","),t=Number(i[0]),n=Number(i[1]);if(this.x+t<0||this.x+t>9||this.y+n+1<0||this.y+n+1>21)return!0;if(0!==game.boardPosition[this.x+t][this.y+n+1])return!0}return!1}},clearLines:function(){for(var e=0,a=game.checkTspin(),i=21;i>=0;i--){for(var t=0,n=0;n<=9;n++)0!==game.boardPosition[n][i]&&t++;if(10==t){for(e++,n=0;n<=9;n++)0!==game.boardPosition[n][i]&&(game.boardPosition[n][i]=0);for(var r=i;r>=0;r--)for(var o=0;o<=9;o++)game.boardPosition[o][r]=0!=r?game.boardPosition[o][r-1]:0;i++}}e>0?player.combo++:player.combo=0,game.sendLines(e,a),player.tspinRotate=!1},checkTspin:function(){if("T"==player.currentPieceName){var e,a=[!1,!1,!1,!1];if(!player.tspinRotate)return"not";if(game.boardPosition[game.piece.x+0][game.piece.y+1])(e=0-game.piece.angle)<0&&(e=4+e),a[e]=!0;if(game.boardPosition[game.piece.x+2][game.piece.y+1])(e=1-game.piece.angle)<0&&(e=4+e),a[e]=!0;if(game.boardPosition[game.piece.x+2][game.piece.y+3])(e=2-game.piece.angle)<0&&(e=4+e),a[e]=!0;if(game.boardPosition[game.piece.x+0][game.piece.y+3])a[e=3-game.piece.angle]=!0;return a[0]&&a[1]&&(a[2]||a[3])?"tspin":a[2]&&a[3]&&(a[1]||a[0])?"mini":"not"}return"not"},sendLines:function(e,a){var i=0;switch(player.combo){case 0:case 1:break;case 2:case 3:case 4:i+=1;break;case 5:case 6:i+=2;break;case 7:case 8:i+=3;break;case 9:case 10:case 11:i+=4;break;case 12:default:i+=5}document.getElementById("line").innerHTML="Combo: "+player.combo.toString()+"<BR>";for(var t=21;t>=18;t--){for(var n=0,r=0;r<=9;r++)""!=game.boardPosition[r][t]&&n++;if(0!=n&&10!=n)break;18==t&&(i+=10,document.getElementById("line").innerHTML+="PERFECT CLEAR!!!!!!!!!!!!!<BR>",player.b2b=!1)}if(i<=5)if(1==player.b2b&&4==e)i+=6,document.getElementById("line").innerHTML+="Back to back TETRIS!!!<BR>";else if(1==player.b2b&&"not"!=a)switch(a){case"mini":i+=2,document.getElementById("line").innerHTML+="Back to back T-spin mini!!!<BR>";break;case"tspin":switch(e){case 1:i+=3,document.getElementById("line").innerHTML+="Back to back T-spin single!!!<BR>";break;case 2:i+=6,document.getElementById("line").innerHTML+="Back to back T-spin double!!!<BR>";break;case 3:i+=9,document.getElementById("line").innerHTML+="Back to back T-spin triple!!!<BR>"}}else{switch(e){case 1:player.b2b=!1,document.getElementById("line").innerHTML+="single<BR>";break;case 2:i+=1,player.b2b=!1,document.getElementById("line").innerHTML+="double!<BR>";break;case 3:i+=2,player.b2b=!1,document.getElementById("line").innerHTML+="Triple!!<BR>";break;case 4:i+=4,document.getElementById("line").innerHTML+="Tetris!!!!!<BR>",player.b2b=!0}switch(a){case"mini":e>0&&(i+=1,player.b2b=!0),document.getElementById("line").innerHTML+="T-spin mini<BR>";break;case"tspin":switch(e){case 1:i+=2,document.getElementById("line").innerHTML+="T-spin single!<BR>";break;case 2:i+=3,document.getElementById("line").innerHTML+="T-spin double!!!<BR>";break;case 3:i+=4,document.getElementById("line").innerHTML+="T-spin triple!!!!!<BR>"}player.b2b=!0}}player.linesSent+=i,e>0&&record.recordLinesSent(i),document.getElementById("line").innerHTML+="lines sent: "+i+"<br>",document.getElementById("line").innerHTML+="total lines sent: "+player.linesSent}}},function(e,a){window.playerObject=function(){this.currentBag=0,this.currentPiece=0,this.currentPieceName="",this.canHold=!0,this.currentHoldPiece="",this.firstHold=!1,this.b2b=!1,this.tspinRotate=!1,this.combo=0,this.linesSent=0,this.incoming=[]}},function(e,a){window.playerObject.prototype.addToIncoming=function(e){player.incoming.push(e),draw.drawPlayerIncoming()}},function(e,a){window.playerObject.prototype.getTotalIncoming=function(){var e=0,a=!0,i=!1,t=void 0;try{for(var n,r=player.incoming[Symbol.iterator]();!(a=(n=r.next()).done);a=!0)number=n.value,e+=number}catch(e){i=!0,t=e}finally{try{a||null==r.return||r.return()}finally{if(i)throw t}}return e}},function(e,a){window.settings={arr:0,das:130,gravity:10}},function(e,a){window.draw={queueCanvas:document.getElementById("queueCanvas"),holdCanvas:document.getElementById("holdCanvas"),playerIncomingCanvas:document.getElementById("playerIncomingCanvas"),makeBlock:function(e,a,i,t,n,r){var o=r.getContext("2d");if(o.fillStyle=n,r==tetrisBoard.canvas){(i>0||t>0)&&(o.globalAlpha=.9);for(var c=0;c<=3;c++){if((e-1)/24==game.piece.oldX[c]&&(a-1)/24==game.piece.oldY[c]){o.fillStyle=n;break}o.fillStyle=shadeColor(n,-.15)}}o.fillRect(e+24*i,a+24*t,24,24),o.beginPath(),o.rect(e+24*i,a+24*t,24,24),o.stroke(),o.globalAlpha=1},drawS:function(e,a,i){this.makeBlock(e,a,2,1,"#69BE28",i),this.makeBlock(e,a,1,1,"#69BE28",i),this.makeBlock(e,a,1,2,"#69BE28",i),this.makeBlock(e,a,0,2,"#69BE28",i)},drawZ:function(e,a,i){this.makeBlock(e,a,0,1,"#ED2939",i),this.makeBlock(e,a,1,1,"#ED2939",i),this.makeBlock(e,a,1,2,"#ED2939",i),this.makeBlock(e,a,2,2,"#ED2939",i)},drawI:function(e,a,i){this.makeBlock(e,a,0,1,"#009FDA",i),this.makeBlock(e,a,1,1,"#009FDA",i),this.makeBlock(e,a,2,1,"#009FDA",i),this.makeBlock(e,a,3,1,"#009FDA",i)},drawT:function(e,a,i){this.makeBlock(e,a,1,1,"#952D98",i),this.makeBlock(e,a,0,2,"#952D98",i),this.makeBlock(e,a,1,2,"#952D98",i),this.makeBlock(e,a,2,2,"#952D98",i)},drawJ:function(e,a,i){this.makeBlock(e,a,0,1,"#0065BD",i),this.makeBlock(e,a,0,2,"#0065BD",i),this.makeBlock(e,a,1,2,"#0065BD",i),this.makeBlock(e,a,2,2,"#0065BD",i)},drawL:function(e,a,i){this.makeBlock(e,a,2,1,"#FF7900",i),this.makeBlock(e,a,0,2,"#FF7900",i),this.makeBlock(e,a,1,2,"#FF7900",i),this.makeBlock(e,a,2,2,"#FF7900",i)},drawO:function(e,a,i){this.makeBlock(e,a,1,1,"#FECB00",i),this.makeBlock(e,a,1,2,"#FECB00",i),this.makeBlock(e,a,2,1,"#FECB00",i),this.makeBlock(e,a,2,2,"#FECB00",i)},clearCanvas:function(e){e.getContext("2d").clearRect(0,0,e.width,e.height)},drawPlayerIncoming:function(){draw.clearCanvas(draw.playerIncomingCanvas);var e=draw.playerIncomingCanvas.getContext("2d");e.fillStyle="red";var a=player.getTotalIncoming();a>22?e.fillRect(0,1,4,draw.playerIncomingCanvas.height):e.fillRect(0,1+draw.playerIncomingCanvas.height-24*a,4,1+draw.playerIncomingCanvas.height-24*a)}}},function(e,a){window.shadeColor=function(e,a){var i=parseInt(e.slice(1),16),t=a<0?0:255,n=a<0?-1*a:a,r=i>>16,o=i>>8&255,c=255&i;return"#"+(16777216+65536*(Math.round((t-r)*n)+r)+256*(Math.round((t-o)*n)+o)+(Math.round((t-c)*n)+c)).toString(16).slice(1)}},function(e,a){window.game.getPieceRotation=function(e){switch(e){case"S":return["1,1|2,1|0,2|1,2","1,1|1,2|2,2|2,3","1,2|2,2|0,3|1,3","0,1|0,2|1,2|1,3"];case"Z":return["0,1|1,1|1,2|2,2","2,1|1,2|2,2|1,3","0,2|1,2|1,3|2,3","1,1|0,2|1,2|0,3"];case"I":return["0,1|1,1|2,1|3,1","2,0|2,1|2,2|2,3","0,2|1,2|2,2|3,2","1,0|1,1|1,2|1,3"];case"T":return["1,1|0,2|1,2|2,2","1,1|1,2|2,2|1,3","0,2|1,2|2,2|1,3","1,1|0,2|1,2|1,3"];case"J":return["0,1|0,2|1,2|2,2","1,1|2,1|1,2|1,3","0,2|1,2|2,2|2,3","1,1|1,2|0,3|1,3"];case"L":return["2,1|0,2|1,2|2,2","1,1|2,3|1,2|1,3","0,2|1,2|2,2|0,3","1,1|1,2|0,1|1,3"];case"O":return["1,1|1,2|2,1|2,2","1,1|1,2|2,1|2,2","1,1|1,2|2,1|2,2","1,1|1,2|2,1|2,2"];default:console.log("no such piece available")}}},function(e,a){window.game.getPieceNumber=function(e){switch(e){case"S":return 1;case"Z":return 2;case"I":return 3;case"T":return 4;case"J":return 5;case"L":return 6;case"O":return 7;default:console.log("no such piece available")}}},function(e,a){window.game.bag={currentBag:[]}},function(e,a){window.game.bag.shuffle=function(e){for(var a,i,t=e.length;0!==t;)i=Math.floor(Math.random()*t),a=e[t-=1],e[t]=e[i],e[i]=a;return e}},function(e,a){window.game.bag.new=function(e){var a=game.bag.currentBag.length;game.bag.currentBag[a]=["S","Z","I","T","J","L","O"],game.bag.shuffle(game.bag.currentBag[a]),game.bag.currentBag[a]=game.bag.currentBag[a].join(",")}},function(e,a){window.game.getPieceColor=function(e){switch(e){case 1:return"#69BE28";case 2:return"#ED2939";case 3:return"#009FDA";case 4:return"#952D98";case 5:return"#0065BD";case 6:return"#FF7900";case 7:return"#FECB00";case 8:return"#696969"}}},function(e,a){window.game.drawBoard=function(){for(var e=0;e<=21;e++)for(var a=0;a<=9;a++)if(0!==this.boardPosition[a][e]){var i=game.getPieceColor(this.boardPosition[a][e]);draw.makeBlock(1+24*a,1+24*e,0,0,i,tetrisBoard.canvas)}}},function(e,a){window.game.drawHold=function(e){switch(draw.clearCanvas(draw.holdCanvas),e){case"S":draw.drawS(1,1,draw.holdCanvas);break;case"Z":draw.drawZ(1,1,draw.holdCanvas);break;case"I":draw.drawI(1,1,draw.holdCanvas);break;case"T":draw.drawT(1,1,draw.holdCanvas);break;case"J":draw.drawJ(1,1,draw.holdCanvas);break;case"L":draw.drawL(1,1,draw.holdCanvas);break;case"O":draw.drawO(1,1,draw.holdCanvas);break;default:console.log("no such piece available")}}},function(e,a){window.game.drawQueue=function(){draw.clearCanvas(draw.queueCanvas);for(var e=player.currentPiece,a=player.currentBag,i=0;i<=3;i++){switch(game.bag.currentBag[a].split(",")[e]){case"S":draw.drawS(1,96*i+1,draw.queueCanvas);break;case"Z":draw.drawZ(1,96*i+1,draw.queueCanvas);break;case"I":draw.drawI(1,96*i+1,draw.queueCanvas);break;case"T":draw.drawT(1,96*i+1,draw.queueCanvas);break;case"J":draw.drawJ(1,96*i+1,draw.queueCanvas);break;case"L":draw.drawL(1,96*i+1,draw.queueCanvas);break;case"O":draw.drawO(1,96*i+1,draw.queueCanvas);break;default:console.log("no such piece available")}++e>=7&&(e=0,a++,null==game.bag.currentBag[player.currentBag+1]&&game.bag.new())}}},function(e,a){window.addEventListener("keyup",function(e){key.onKeyUp(e)},!1),window.addEventListener("keydown",function(e){key.onKeyDown(e)},!1),window.key={pressed:{},left:37,up:38,right:39,down:40,control:17,command:91,space:32,shift:16,onKeyDown:function(e){window.dokeydown(e.keyCode),this.pressed[e.keyCode]=(new Date).getTime()},onKeyUp:function(e){window.dokeyup(e.keyCode),delete this.pressed[e.keyCode]},moveLeft:function(){key.pressed[key.left]>0&&(game.piece.checkCollision(2)||(player.tspinRotate=!1,game.piece.lockdown(),game.piece.x--,game.ghost.update(),game.piece.update(),game.drawBoard()),this.canMoveLeft=setTimeout(key.moveLeft,settings.arr))},moveRight:function(){key.pressed[key.right]>0&&(game.piece.checkCollision(0)||(player.tspinRotate=!1,game.piece.lockdown(),game.piece.x++,game.ghost.update(),game.piece.update(),game.drawBoard()),this.canMoveRight=setTimeout(key.moveRight,settings.arr))}},window.dokeydown=function(e){switch(e){case key.control:case key.command:null==key.pressed[key.control]&&void 0===key.pressed[key.command]&&game.piece.canRotate(-1)&&(game.piece.rotationLimit++,clearTimeout(game.piece.lockDownTimer),game.piece.lockDownTimer=!1,game.piece.angle--,game.piece.angle<0&&(game.piece.angle=3),player.tspinRotate=!0,game.piece.lockdown(),game.ghost.update(),game.piece.update(),game.drawBoard());break;case key.left:void 0===key.pressed[key.left]&&(key.canMoveLeft=setTimeout(key.moveLeft,settings.das),game.piece.checkCollision(2)||(game.piece.rotationLimit++,clearTimeout(game.piece.lockDownTimer),game.piece.lockDownTimer=!1,player.tspinRotate=!1,game.piece.lockdown(),game.piece.x--,game.ghost.update(),game.piece.update(),game.drawBoard()),delete key.pressed[key.right]);break;case key.space:if(void 0===key.pressed[key.space]){for(;!game.piece.checkCollision(1);)player.tspinRotate=!1,game.piece.y++;game.ghost.update(),game.piece.update(),game.drawBoard(),game.piece.die()}break;case key.shift:void 0===key.pressed[key.shift]&&(player.tspinRotate=!1,game.hold());break;case key.up:void 0===key.pressed[key.up]&&game.piece.canRotate(1)&&(game.piece.rotationLimit++,clearTimeout(game.piece.lockDownTimer),game.piece.lockDownTimer=!1,game.piece.angle++,game.piece.angle>3&&(game.piece.angle=0),player.tspinRotate=!0,game.piece.lockdown(),game.ghost.update(),game.piece.update(),game.drawBoard());break;case key.right:void 0===key.pressed[key.right]&&(key.canMoveRight=setTimeout(key.moveRight,settings.das),game.piece.checkCollision(0)||(game.piece.rotationLimit++,clearTimeout(game.piece.lockDownTimer),game.piece.lockDownTimer=!1,player.tspinRotate=!1,game.piece.lockdown(),game.piece.x++,game.ghost.update(),game.piece.update(),game.drawBoard()),delete key.pressed[key.left]);break;case key.down:void 0===key.pressed[key.down]&&(game.piece.checkCollision(1)||(clearInterval(game.piece.interval),game.piece.interval=setInterval(game.piece.gravityInterval,settings.gravity),game.piece.y++,game.piece.y>game.piece.lowestLine&&(game.piece.lowestLine=game.piece.y,game.piece.rotationLimit=0,clearTimeout(game.piece.lockDownTimer),game.piece.lockDownTimer=!1),player.tspinRotate=!1,game.piece.lockdown(),game.ghost.update(),game.piece.update(),game.drawBoard()))}},window.dokeyup=function(e){switch(e){case key.down:clearInterval(game.piece.interval),game.piece.interval=setInterval(game.piece.gravityInterval,1e3);break;case key.left:clearTimeout(key.canMoveLeft);break;case key.right:clearTimeout(key.canMoveRight)}}},function(e,a){window.record={startTime:0,boardPosition:"",linesSent:"",recordBoardPosition:function(){for(var e="",a=0;a<=21;a++)for(var i=0;i<=9;i++)game.boardPosition[i][a]>0&&(e+=game.boardPosition[i][a]),e+=".";e+=","+((new Date).getTime()-this.startTime)+"|",this.boardPosition+=e},recordLinesSent:function(e){var a="";a+=e.toString()+",",a+=(new Date).getTime()-this.startTime+"|",this.linesSent+=a}}},function(e,a){window.tetrisBoard={canvas:document.getElementById("boardCanvas"),start:function(){this.blockWidth=24,this.canvas.width=10*this.blockWidth+2,this.canvas.height=22*this.blockWidth+2,this.context=this.canvas.getContext("2d")},drawGrid:function(){for(var e=1;e<=this.canvas.width;e+=this.blockWidth)this.context.moveTo(e,0),this.context.lineTo(e,this.canvas.height);for(var a=1;a<=this.canvas.height;a+=this.blockWidth)this.context.moveTo(0,a),this.context.lineTo(this.canvas.width,a);this.context.strokeStyle="black",this.context.stroke();var i=this.canvas.toDataURL();this.canvas.style.backgroundImage="url("+i+")"}}},function(e,a){window.game.addGarbage=function(e){for(var a=Math.floor(10*Math.random()),i=0;i<=20;i++)for(var t=0;t<=9;t++)game.boardPosition[t][i]=game.boardPosition[t][i+e];for(i=0;i<e;i++){for(t=0;t<=9;t++)game.boardPosition[t][21-i]=8;game.boardPosition[a][21-i]=0}game.ghost.update(),game.piece.update(),game.drawBoard()}},function(e,a){window.game.applyGarbage=function(){var e=!0,a=!1,i=void 0;try{for(var t,n=player.incoming[Symbol.iterator]();!(e=(t=n.next()).done);e=!0){var r=t.value;game.addGarbage(r)}}catch(e){a=!0,i=e}finally{try{e||null==n.return||n.return()}finally{if(a)throw i}}player.incoming=[],draw.drawPlayerIncoming()}},function(e,a){window.game.checkLoss=function(){for(var e=!1,a=0;a<=1;a++)for(var i=3;i<=6;i++)0!=game.boardPosition[i][a]&&(e=!0);return e}},function(e,a){window.game.losingGray=function(){for(var e=0;e<=21;e++)for(var a=0;a<=9;a++)0!=game.boardPosition[a][e]&&(game.boardPosition[a][e]=8);game.drawBoard()}},function(e,a){window.game.newGame=function(){if(game.checkLoss()||!begin){begin=!0,game.piece&&(clearInterval(game.piece.interval),game.piece=null),player=new playerObject,record.startTime=(new Date).getTime(),game.bag.currentBag=[],game.bag.new();for(var e=-1;e<=10;e++){game.boardPosition[e]=[];for(var a=-1;a<=22;a++)game.boardPosition[e][a]=0,-1!=e&&10!=e&&-1!=a&&22!=a||(game.boardPosition[e][a]=1)}game.spawnPiece(),game.piece.update(),game.drawQueue(),game.drawHold()}}},function(e,a,i){"use strict";i.r(a);i(1),i(2),i(3),i(4),i(5),i(6),i(7),i(8),i(9),i(10),i(11),i(12),i(13),i(14),i(15),i(16),i(17),i(18),i(19),i(20),i(21),i(22),i(23),i(24)}]);